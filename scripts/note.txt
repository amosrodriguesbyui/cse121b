document.querySelector('#preference').addEventListener('submit', function(event) {
    event.preventDefault();
  
    const selectedGenres = Array.from(document.querySelectorAll('input[name="genre"]:checked')).map(input => input.value);
    const selectedYears = document.querySelector('#release-year').value.split(',').map(year => parseInt(year.trim()));
  
    const apiUrl = `https://api.themoviedb.org/3/movie/550?api_key=ff4b1af46bc95c0c29c24911794de903`;

    fetch(apiUrl)
      .then(response => {
        if (!response.ok) {
          throw new Error('Network response was not ok');
        }
        return response.json();
      })
      .then(data => {
        const filteredMovies = filterMoviesByPreferences(data.results, selectedGenres, selectedYears);
        displayMovieRecommendations(filteredMovies);
      })
      .catch(error => {
        console.error('Error fetching data:', error);
      });
});
  
function filterMoviesByPreferences(movies, selectedGenres, selectedYears) {
    return movies.filter(movie => {
      if (!movie.release-year) return false;
      
      const movieReleaseYear = parseInt(movie.release_date.split('-')[0]);
      const movieGenres = movie.genre_ids; // Assuming genre_ids are available in the API response
      return (
        selectedGenres.some(genre => movieGenres.includes(genre)) &&
        selectedYears.includes(movieReleaseYear)
      );
    });
}

  
function displayMovieRecommendations(movies) {
    const movieList = document.querySelector('#movieList');
    movieList.innerHTML = '';
  
    movies.forEach(movie => {
      const movieElement = document.createElement('div');
      movieElement.classList.add('movie');
      movieElement.innerHTML = `
        <h2>${movie.title}</h2>
        <p><strong>Genres:</strong> ${movie.genre_ids.join(', ')}</p>
        <p><strong>Rating:</strong> ${movie.vote_average}</p>
        <p><strong>Overview:</strong> ${movie.overview}</p>
      `;
      movieList.appendChild(movieElement);
    });
}
